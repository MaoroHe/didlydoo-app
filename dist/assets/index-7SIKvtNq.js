(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))e(d);new MutationObserver(d=>{for(const t of d)if(t.type==="childList")for(const l of t.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&e(l)}).observe(document,{childList:!0,subtree:!0});function o(d){const t={};return d.integrity&&(t.integrity=d.integrity),d.referrerPolicy&&(t.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?t.credentials="include":d.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function e(d){if(d.ep)return;d.ep=!0;const t=o(d);fetch(d.href,t)}})();let I=a=>{const n=document.getElementById("ulDate"),o=document.createElement("li"),e=a.value,d=document.createTextNode(e);e!=""&&(o.appendChild(d),o.className=`date ${e}`,n.appendChild(o),a.value="")},L=()=>{const a=document.querySelector(".addBtn"),n=document.getElementById("addDate"),o=document.getElementById("close"),e=document.getElementById("boite"),d=document.getElementById("eventDate");a.addEventListener("click",t=>{e.style.display="block"}),o.addEventListener("click",t=>{e.style.display="none"}),document.addEventListener("click",t=>{t.target==e&&(e.style.display="none")}),n.addEventListener("click",t=>{t.preventDefault(),I(d)})};function A(a,n){fetch(`http://localhost:3000/api/events/${a}`,{method:"DELETE"}).then(o=>{o.ok?n.remove():console.error("Erreur lors de la suppression de l'événement")}).catch(o=>{console.error("Erreur lors de la suppression de l'événement :",o)})}function D(a){fetch(`http://localhost:3000/api/events/${a}/`).then(n=>n.json()).then(n=>{$(n)}).catch(n=>{console.error("Erreur lors de la récupération de l'événement :",n)})}function $(a){const n=document.querySelector(".eventBox");n.innerHTML=`

        <h2 class='darkE'>Edit Event</h2>
        <form id="edit-form">
            <label for="name">Name:</label>
            <input type="text" class='nameInput' id="name" value="${a.name}" required>
            
            <label for="description">Description:</label>
            <textarea id="description" class='nameInput' required>${a.description}</textarea>
            
            <label for="author">Author:</label>
            <input type="text" class='nameInput' id="author" value="${a.author}" required>
            
            <button type="submit">Save Changes</button>
        </form>`,document.getElementById("edit-form").addEventListener("submit",e=>{e.preventDefault();const d=document.getElementById("name").value,t=document.getElementById("description").value,l=document.getElementById("author").value;N(a.id,d,t,l)})}function N(a,n,o,e){const d={name:n,description:o,author:e};fetch(`http://localhost:3000/api/events/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}).then(t=>{t.ok?C():console.error("Error updating the event")}).catch(t=>{console.error("Error updating the event:",t)})}const x=document.getElementById("events");let y=[],m=[],k=[];function T(a){x.innerHTML="";let n=0;a.forEach(o=>{const e=document.createElement("div");e.classList.add("eventBox"),e.innerHTML=`<h2 class="events__title">${o.name}</h2>
        <p class="events__description">${o.description}</p>
        <p class="events__author">${o.author}</p>
        <button class="events__edit-button edit-button" data-id="${o.id}">Edit Event</button>
        <button class="events__delete-button delete-button" data-id="${o.id}">Delete Event</button>`;const d=document.createElement("table"),t=document.createElement("thead"),l=document.createElement("tbody"),r=document.createElement("tr"),v=document.createElement("th");v.textContent="Attendees\\Dates",r.appendChild(v),o.dates.forEach(c=>{const s=document.createElement("th");s.textContent=c.date,r.appendChild(s)}),t.appendChild(r),d.appendChild(t),o.dates[0].attendees.forEach(c=>{const s=document.createElement("tr"),f=document.createElement("td");f.textContent=c.name,y.includes(c.name)||y.push(c.name),s.appendChild(f),o.dates.forEach(p=>{const u=document.createElement("td");u.textContent=p.attendees.find(B=>B.name===c.name).available,s.appendChild(u)}),l.appendChild(s)}),d.appendChild(l),e.appendChild(d),x.appendChild(e);const g=e.querySelector(".delete-button");g.addEventListener("click",()=>{const c=g.getAttribute("data-id");A(c,e)});const E=document.createElement("form"),h=document.createElement("input");h.classList.add("nameInput"),h.type="text",h.placeholder="Nom du participant",E.appendChild(h);const i=document.createElement("div");i.classList.add("checkboxes"),o.dates.forEach(c=>{const s=document.createElement("input");s.type="checkbox",s.setAttribute("id",`checkbox ${n}`),s.setAttribute("class",`checkbox ${n}`),s.name=`${c.date}`,s.addEventListener("change",()=>{const p=h.value;if(y.includes(p))for(let u=0;u<m.length;u++)m[u].id===o.id&&m[u].name===p&&m[u].date===c.date&&(s.checked?m[u].available=!0:m[u].available=!1);else s.checked?k.push({date:c.date,available:!0}):k.push({date:c.date,available:!1})});const f=document.createElement("label");f.setAttribute("for",`checkbox ${n}`),f.textContent=c.date,i.appendChild(s),i.appendChild(f),c.attendees.forEach(p=>{m.push({id:o.id,name:p.name,date:c.date,available:p.available})}),n++}),E.appendChild(i);const b=document.createElement("button");b.textContent="Submit",b.addEventListener("click",c=>{c.preventDefault();const s=h.value;_(o.id,s)}),E.appendChild(b),e.appendChild(E);const S=e.querySelector(".events__edit-button");S.addEventListener("click",()=>{const c=S.getAttribute("data-id");D(c)})})}function _(a,n){let o=[];y.includes(n)?(m.forEach(e=>{e.id===a&&e.name===n&&o.push({date:e.date,available:e.available})}),fetch("http://localhost:3000/api/events/").then(e=>e.json()).then(e=>{e.forEach(d=>{d.id===a&&d.dates.forEach(t=>{t.attendees.forEach(l=>{l.name===n&&fetch(`http://localhost:3000/api/events/${a}/attend`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n,dates:o})}).then(r=>r.json()).then(r=>{console.log(r)}).catch(r=>{console.error("Erreur lors de la mise à jour de la disponibilité du participant :",r)})})})})})):(fetch("http://localhost:3000/api/events/").then(e=>e.json()).then(e=>{e.forEach(d=>{d.id===a&&fetch(`http://localhost:3000/api/events/${a}/attend`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n,dates:k})}).then(t=>t.json()).then(t=>{console.log(t)}).catch(t=>{console.error("Erreur lors de la mise à jour de la disponibilité du participant :",t)})})}),y.push(n),fetch("http://localhost:3000/api/events/").then(e=>e.json()).then(e=>{e.forEach(d=>{d.dates.forEach(t=>{t.attendees.forEach(l=>{l.name===n&&m.push({id:d.id,name:l.name,date:t.date,available:l.available})})})})})),location.reload()}let w=()=>{const a=document.getElementById("eventName"),n=document.getElementById("eventDesc"),o=document.getElementById("eventAuthor"),e=document.getElementsByClassName("date"),d=document.getElementById("ulDate");let t=[];for(let i=0,b=e.length;i<b;i++)t.push(e[i].innerHTML);for(let i of t)d.firstChild.remove();const l=a.value,r=n.value,v=o.value;l.length<=256||r.length<=512||v.length<=64?(fetch("http://localhost:3000/api/events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:l,description:r,author:v,dates:t})}),a.value="",n.value="",o.value=""):alert("Aucun champs ne doit dépasser 256 charactères.")};function C(){fetch("http://localhost:3000/api/events/").then(a=>a.json()).then(a=>{console.log(a),T(a)})}let O=()=>{const a=document.getElementById("eventSubmit"),n=document.getElementById("events");a.addEventListener("click",o=>{o.preventDefault(),w(),boite.style.display="none",n.innerHTML="",setTimeout(C,100)})},j=()=>{document.querySelector(".theme-switch__checkbox").addEventListener("change",n=>{document.getElementById("darkmode").checked?(document.body.className="darkmode",window.localStorage.setItem("darkmod",!0)):(document.body.className="",window.localStorage.setItem("darkmod",!1))})},q=()=>{const a=document.querySelector(".theme-switch__checkbox");localStorage.getItem("darkmod")=="true"?(document.body.className="darkmode",a.checked=!0,document.documentElement.style.backgroundColor="#8B888B",window.localStorage.setItem("darkmod",!0)):(document.body.className="",window.localStorage.setItem("darkmod",!1))};document.querySelector(".header__btn");let P=[],H=[];q();C();O();j();console.log(H);console.log(P);L();
